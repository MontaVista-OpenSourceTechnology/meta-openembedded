origin: https://groups.google.com/a/mozilla.org/g/dev-tech-crypto/c/t9JmsYkujWM/m/HjKuk-ngBAAJ

Upstream-Status: Backport [import from debian https://salsa.debian.org/lts-team/packages/nss/-/blob/debian/bullseye/debian/patches/CVE-2024-6609.patch]
CVE: CVE-2024-6609
Signed-off-by: Vijay Anusuri <vanusuri@mvista.com>
---

diff --git a/nss/lib/freebl/ec.c b/nss/lib/freebl/ec.c
--- a/nss/lib/freebl/ec.c
+++ b/nss/lib/freebl/ec.c
@@ -297,6 +297,10 @@ done:

 cleanup:
     mp_clear(&k);
+    if (err < MP_OKAY) {
+        MP_TO_SEC_ERROR(err);
+        rv = SECFailure;
+    }
     if (rv) {
         PORT_FreeArena(arena, PR_TRUE);
     }
