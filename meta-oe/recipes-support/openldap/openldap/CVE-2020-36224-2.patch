From dd56cbcdf6ad1226d4e7b4005a4ae49729156f58 Mon Sep 17 00:00:00 2001
From: Howard Chu <hyc@openldap.org>
Date: Mon, 30 Nov 2020 16:20:18 +0000
Subject: [PATCH 07/14] ITS#9409 saslauthz: use slap_sl_free in prev commit

Upstream Status: Backport https://git.openldap.org/openldap/openldap/-/commit/554dff1927176579d652f2fe60c90e9abbad4c65
CVE: CVE-2020-36224 patch #2

Signed-off-by: Anand Je Sypureddy <anandje@mvista.com>
---
 servers/slapd/saslauthz.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/servers/slapd/saslauthz.c b/servers/slapd/saslauthz.c
index aed7e21..351be91 100644
--- a/servers/slapd/saslauthz.c
+++ b/servers/slapd/saslauthz.c
@@ -860,7 +860,7 @@ done:
 
 	if ( lud_dn ) {
 		if ( ludp->lud_dn != lud_dn ) {
-			ch_free( ludp->lud_dn );
+			slap_sl_free( ludp->lud_dn, ctx );
 		}
 		ludp->lud_dn = lud_dn;
 	}
-- 
2.29.0

