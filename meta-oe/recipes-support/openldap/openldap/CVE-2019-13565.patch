From 0fa0f8ff078a3a49a19574eecaea797b7a55a665 Mon Sep 17 00:00:00 2001
From: Howard Chu <hyc@openldap.org>
Date: Wed, 10 Jul 2019 21:29:39 +0100
Subject: [PATCH] ITS#9052 zero out sasl_ssf in connection_init

Upstream status: backport https://www.openldap.org/devel/gitweb.cgi?p=openldap.git;a=commitdiff;h=0fa0f8ff078a3a49a19574eecaea797b7a55a665
CVE: CVE-2019-13565

Signed-off-by: Rahul Chauhan <rahulk@mvista.com>
---
 servers/slapd/connection.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/servers/slapd/connection.c b/servers/slapd/connection.c
index 34ecaa8..a9a8d11 100644
--- a/servers/slapd/connection.c
+++ b/servers/slapd/connection.c
@@ -535,7 +535,7 @@ Connection * connection_init(
	c->c_close_reason = "?";			/* should never be needed */

	c->c_ssf = c->c_transport_ssf = ssf;
-	c->c_tls_ssf = 0;
+	c->c_tls_ssf = c->c_sasl_ssf = 0;

 #ifdef HAVE_TLS
	if ( flags & CONN_IS_TLS ) {
--
2.7.4
