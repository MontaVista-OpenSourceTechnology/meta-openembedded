From 84bb16d34a76a4b261aff98661c6cffae39887b4 Mon Sep 17 00:00:00 2001
From: Howard Chu <hyc@openldap.org>
Date: Mon, 30 Nov 2020 11:45:46 +0000
Subject: [PATCH 06/14] ITS#9409 saslauthz: use ch_free on normalized DN

Upstream Status: Backport https://git.openldap.org/openldap/openldap/-/commit/c0b61a9486508e5202aa2e0cfb68c9813731b439
CVE: CVE-2020-36224 patch #1

Signed-off-by: Anand Je Sypureddy <anandje@mvista.com>
---
 servers/slapd/saslauthz.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/servers/slapd/saslauthz.c b/servers/slapd/saslauthz.c
index c453b4a..aed7e21 100644
--- a/servers/slapd/saslauthz.c
+++ b/servers/slapd/saslauthz.c
@@ -860,7 +860,7 @@ done:
 
 	if ( lud_dn ) {
 		if ( ludp->lud_dn != lud_dn ) {
-			ber_memfree( ludp->lud_dn );
+			ch_free( ludp->lud_dn );
 		}
 		ludp->lud_dn = lud_dn;
 	}
-- 
2.29.0

