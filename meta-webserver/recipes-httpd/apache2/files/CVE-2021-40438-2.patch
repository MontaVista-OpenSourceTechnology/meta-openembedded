From 6e768a811c59ca6a0769b72681aaef381823339f Mon Sep 17 00:00:00 2001
From: Stefan Eissing <icing@apache.org>
Date: Thu, 23 Sep 2021 12:29:03 +0000
Subject: [PATCH] Merge of r1893516 from trunk:

   *) mod_rewrite: Fix UDS ("unix:") scheme for [P] rules.  PR 57691 + 65590.



git-svn-id: https://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.x@1893556 13f79535-47bb-0310-9956-ffa450edef68
---
 changes-entries/rewrite_uds.txt | 2 ++
 modules/mappers/mod_rewrite.c   | 7 +++++++
 2 files changed, 9 insertions(+)
 create mode 100644 changes-entries/rewrite_uds.txt

#diff --git a/changes-entries/rewrite_uds.txt b/changes-entries/rewrite_uds.txt
#new file mode 100644
#index 00000000000..4b752a8b46c
#--- /dev/null
#+++ b/changes-entries/rewrite_uds.txt
#@@ -0,0 +1,2 @@
#+  *) mod_rewrite: Fix UDS ("unix:") scheme for [P] rules.  PR 57691 + 65590.
#+     [Janne Peltonen <janne.peltonen sange.fi>]
#\ No newline at end of file
--- a/modules/mappers/mod_rewrite.c
+++ b/modules/mappers/mod_rewrite.c
@@ -620,6 +620,13 @@ static unsigned is_absolute_uri(char *ur
             return 6;
         }
         break;
+
+    case 'u':
+    case 'U':
+        if (!ap_cstr_casecmpn(uri, "nix:", 4)) {        /* unix:     */
+            *sqs = 1;
+            return 5;
+        }
     }
 
     return 0;
