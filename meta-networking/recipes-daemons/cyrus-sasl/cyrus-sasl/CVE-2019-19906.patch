From a13e97e8477e55a00030c81aa89039f0d502d2c4 Mon Sep 17 00:00:00 2001
From: Anand Je Sypureddy <anandje@mvista.com>
Date: Wed, 29 Jan 2020 16:25:00 +0530
Subject: [PATCH] Off by one in _sasl_add_string function

https://github.com/cyrusimap/cyrus-sasl/issues/587

Upstream status: Backport
CVE: CVE-2019-19906

Signed-off-by: Anand Je Sypureddy <anandje@mvista.com>
---
 lib/common.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/lib/common.c b/lib/common.c
index e0f59eb..324c3a1 100644
--- a/lib/common.c
+++ b/lib/common.c
@@ -192,7 +192,7 @@ int _sasl_add_string(char **out, size_t *alloclen,
 
   if (add==NULL) add = "(null)";
 
-  addlen=strlen(add); /* only compute once */
+  addlen=strlen(add)+1; /* only compute once */
   if (_buf_alloc(out, alloclen, (*outlen)+addlen)!=SASL_OK)
     return SASL_NOMEM;
 
-- 
2.7.4

