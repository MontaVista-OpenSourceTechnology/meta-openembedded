From f11255a82860c3eb07fe9f723aab633dd245c903 Mon Sep 17 00:00:00 2001
From: Vijay Anusuri <vanusuri@mvista.com>
Date: Mon, 20 Nov 2023 05:23:41 +0000
Subject: [PATCH] CVE-2023-46316 Fix command line parsing in wrappers.

Backported changes between traceroute-2.1.2.tar.gz and traceroute-2.1.3.tar.gz

Upstream-Status: Backport [https://sourceforge.net/projects/traceroute/files/traceroute/traceroute-2.1.3]
CVE: CVE-2023-46316
Signed-off-by: Vijay Anusuri <vanusuri@mvista.com>
---
 wrappers/tcptraceroute    | 2 +-
 wrappers/tracepath        | 2 +-
 wrappers/traceproto       | 2 +-
 wrappers/traceroute-nanog | 2 +-
 4 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/wrappers/tcptraceroute b/wrappers/tcptraceroute
index fe90a42..8e0a3f6 100755
--- a/wrappers/tcptraceroute
+++ b/wrappers/tcptraceroute
@@ -26,7 +26,7 @@ usage () {
 }
 
 
-PARSED=`getopt 'hvdnNi:l:f:Fm:p:q:w:s:t:SAE' "$@"`
+PARSED=`getopt -- 'hvdnNi:l:f:Fm:p:q:w:s:t:SAE' "$@"`
 [ $? != 0 ] && exit 2
 
 eval set -- "$PARSED"
diff --git a/wrappers/tracepath b/wrappers/tracepath
index 987b998..448f031 100755
--- a/wrappers/tracepath
+++ b/wrappers/tracepath
@@ -25,7 +25,7 @@ usage () {
 }
 
 
-PARSED=`getopt 'hnbl:' "$@"`
+PARSED=`getopt -- 'hnbl:' "$@"`
 [ $? != 0 ] && exit 2
 
 eval set -- "$PARSED"
diff --git a/wrappers/traceproto b/wrappers/traceproto
index 988fdc5..5dfd9a7 100755
--- a/wrappers/traceproto
+++ b/wrappers/traceproto
@@ -38,7 +38,7 @@ warning () {
 }
  
 
-PARSED=`getopt 'cCTfAhvRp:d:D:s:S:m:M:w:W:a:P:F:k:I:H:i:o:t:' "$@"`
+PARSED=`getopt -- 'cCTfAhvRp:d:D:s:S:m:M:w:W:a:P:F:k:I:H:i:o:t:' "$@"`
 [ $? != 0 ] && exit 2
 
 eval set -- "$PARSED"
diff --git a/wrappers/traceroute-nanog b/wrappers/traceroute-nanog
index 29fd2a4..aac4c83 100755
--- a/wrappers/traceroute-nanog
+++ b/wrappers/traceroute-nanog
@@ -31,7 +31,7 @@ warning () {
 }
  
 
-PARSED=`getopt 'adnruvAMOPQU$w:S:m:p:q:g:t:s:I:f:T:' "$@"`
+PARSED=`getopt -- 'adnruvAMOPQU$w:S:m:p:q:g:t:s:I:f:T:' "$@"`
 [ $? != 0 ] && {
     usage
     exit 2
-- 
2.20.1

