From 8f1c84d6dae3b95f87dfb03fc53461df6825d94c Mon Sep 17 00:00:00 2001
From: Gerald Combs <gerald@wireshark.org>
Date: Wed, 12 Feb 2020 12:07:52 -0800
Subject: [PATCH 2/4] WiMax DLMAP: Fix a large loop.

Make sure we advance our offset.

Upstream Status: Backport [https://code.wireshark.org/review/gitweb?p=wireshark.git;a=commit;h=6b98dc63701b]
CVE: CVE-2020-9430 patch #2

Bug: 16383
Ping-Bug: 16368
Change-Id: I4949cb0988601dbe545d0bc22de4d654b4e61204
Reviewed-on: https://code.wireshark.org/review/36085
Reviewed-by: Gerald Combs <gerald@wireshark.org>
Petri-Dish: Gerald Combs <gerald@wireshark.org>
Reviewed-by: Anders Broman <a.broman58@gmail.com>
(cherry picked from commit 6dad599a8a1bda8b8e999cc4a7e460140e4ecc0a)
Reviewed-on: https://code.wireshark.org/review/36094
Signed-off-by: Anand Je Sypureddy <anandje@mvista.com>
---
 plugins/wimax/msg_dlmap.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/plugins/wimax/msg_dlmap.c b/plugins/wimax/msg_dlmap.c
index bb4a2e0..d3972f6 100644
--- a/plugins/wimax/msg_dlmap.c
+++ b/plugins/wimax/msg_dlmap.c
@@ -2386,6 +2386,7 @@ gint wimax_decode_dlmapc(tvbuff_t *tvb, packet_info *pinfo, proto_tree *base_tre
 	{
 		expert_add_info_format(pinfo, ti, &ei_mac_header_invalid_length,
 		"Invalid length: %d.", mac_len);
+		return sizeof(mac_crc);
 	}
 	else if (MIN(tvb_len, tvb_reported_length(tvb)) >= mac_len)
 	{
-- 
2.26.2

